function envira_social_get_query_arg(e,a){e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=o.exec(a);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function envira_clean_base_link(e){return e=envira_remove_URL_parameter(e,"doing_wp_cron"),e=envira_remove_URL_parameter(e,"envira_social_gallery_id"),e=envira_remove_URL_parameter(e,"envira_social_gallery_item_id"),e=envira_remove_URL_parameter(e,"rand"),e=envira_remove_URL_parameter(e,"envira"),e=envira_remove_URL_parameter(e,"envira_album"),e=envira_remove_URL_parameter(e,"album_id")}function envira_remove_URL_parameter(e,a){var o=e.split("?");if(o.length>=2){for(var i=encodeURIComponent(a)+"=",n=o[1].split(/[&;]/g),t=n.length;t-- >0;)-1!==n[t].lastIndexOf(i,0)&&n.splice(t,1);return e=o[0]+(n.length>0?"?"+n.join("&"):"")}return e}jQuery(document).ready(function($){$(document).on("click",".envira-social-buttons a",function(e){e.preventDefault();var a=window.location.hash,o=$(this).attr("href"),i=$(this).parent().data("width"),n=$(this).parent().data("height"),t=$(this).parent().data("network"),l=$(this).parent().data("deeplinking"),r=!1,c=!1;if($(".envira-pagination").length>0&&(r=envira_social_get_query_arg("page",$(this).attr("href")),r||(r=$(this).closest(".envira-gallery-wrap").find(".envira-pagination").data("page"),r||(r=$("img.envirabox-image").data("pagination-page")))),r)var c=r+"/";else var c="";if("#"==o){var d=$(".envirabox-wrap"),s=d.data("envira-src"),g=d.data("envira-title"),p=d.data("envira-fullsize-src"),v=d.data("envira-caption"),_=d.data("envira-gallery-id"),u=d.data("envira-item-id"),f=Math.floor(1e4*Math.random()+1),h=envira_social_get_query_arg("envira",window.location.href);if(envira_social.debug&&(console.log("full_size_image url (lightbox):"),console.log(p),console.log(d),console.log("----")),"undefined"!=typeof d.attr("data-envira-album-id")){var m=d.data("envira-album-id");envira_social.debug&&(console.log("album_id is currently:"),console.log(m))}else{var m=!1;envira_social.debug&&console.log("not album_id detected.")}h="undefined"!=typeof h&&null!==h?"envira="+h:"",("undefined"==typeof p||null===p)&&(p=s),envira_social.debug&&(console.log("detected gallery_id (lightbox):"+_),console.log("detected gallery_item_id (lightbox):"+u),console.log("detected hash:"+a),console.log("detected envira_permalink:"+h)),"undefined"==typeof g&&(v=""),"undefined"==typeof v&&(v="");var b=a.length>0?window.location.href.split("#")[0]:window.location.href.split("?")[0];switch(envira_social.debug&&console.log("base_link (lightbox):"+b),b=envira_clean_base_link(b),envira_social.debug&&console.log("base_link cleaned (lightbox):"+b),U=a.length>0?b+"?envira_album_id="+m+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+u+"&rand="+f+"&"+h+a:b+c+"?envira_album_id="+m+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+u+"&rand="+f+"&"+h,envira_social.debug&&console.log("link (lightbox):"+U),t){case"facebook":var y="",w="",g="",x="";"undefined"!=typeof $(this).attr("data-envira-social-facebook-text")&&(w=decodeURIComponent($(this).data("envira-social-facebook-text")),w=w.replace(new RegExp("\\+","g")," "),""==$.trim(w)&&(w=" "),envira_social.debug&&(console.log("updating facebook_text"),console.log(w))),"undefined"!=typeof $(this).attr("data-envira-facebook-quote")&&(y=decodeURIComponent($(this).data("envira-facebook-quote")),y=y.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote"),console.log(y))),"undefined"!=typeof $(this).attr("data-envira-title")&&(g=decodeURIComponent($(this).data("envira-title")),g=g.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title"),console.log(g))),"undefined"!=typeof $(".envirabox-wrap").find("img.envirabox-image").data("envira-facebook-tags-manual")?(x=decodeURIComponent($(".envirabox-wrap").find("img.envirabox-image").data("envira-facebook-tags-manual")),x=x.replace(new RegExp("\\+","g")," "),x=x.replace(/-/g,""),envira_social.debug&&(console.log("updating tags"),console.log(x))):envira_social.debug&&(console.log("updating tags - missing"),console.log($(".envirabox-wrap").find("img.envirabox-image").data("envira-facebook-tags-manual"))),o="https://www.facebook.com/dialog/feed?app_id="+envira_social.facebook_app_id+"&display=popup&link="+U+"&picture="+s+"&name="+g+"&caption="+v+"&description="+w+"&redirect_uri="+U+"#envira_social_sharing_close";break;case"twitter":var R="";"undefined"!=typeof $(this).attr("data-envira-social-twitter-text")&&(R=decodeURIComponent($(this).data("envira-social-twitter-text")),R=R.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating twitter_text"),console.log(R))),envira_social.debug&&(console.log("updating twitter_text"),console.log(R),console.log("caption"));var v=v.replace(/"/g,"&quote;");o="https://twitter.com/intent/tweet?text="+encodeURIComponent($.trim($.trim(v)+" "+$.trim(R)))+"&url="+encodeURIComponent(U),envira_social.debug&&(console.log("twitter url (lightbox):"),console.log(o));break;case"google":o="https://plus.google.com/share?url="+encodeURIComponent(U),envira_social.debug&&(console.log("google url (lightbox):"),console.log(o));break;case"pinterest":o="http://pinterest.com/pin/create/button/?url="+U+"&media="+s+"&description="+v,envira_social.debug&&(console.log("pinterest url (lightbox):"),console.log(o));break;case"email":if(envira_social.debug&&(console.log("envira_permalink (lightboxx):"),console.log(h),console.log(h.length)),"undefined"!=typeof h&&null!==h&&h.length>0)var k=a.length>0?b+"?"+h+a:b+c+"?"+h;else var k=a.length>0?b+"?"+a:b+c;o="mailto:?subject="+encodeURIComponent(v)+"&body=Photo: "+p+"%0D%0AURL: "+k,envira_social.debug&&(console.log("email url (lightbox):"),console.log(p),console.log(o),console.log(U))}}else{var _=$(this).data("envira-gallery-id"),u=$(this).data("envira-item-id"),f=Math.floor(1e4*Math.random()+1),h=envira_social_get_query_arg("envira",window.location.href);if(envira_social.debug&&(console.log("detected gallery_id (gallery): "+_),console.log("detected gallery_item_id (gallery): "+u)),"undefined"!=typeof $(this).attr("data-envira-album-id")){var m=$(this).data("envira-album-id");envira_social.debug&&(console.log("album_id is currently:"),console.log(m))}else var m=!1;switch(h="undefined"!=typeof h&&null!==h?"envira="+h:"",envira_social.debug&&console.log("envira_permalink:"+h),t){case"facebook":var y="",w="",g="",x="",v="",s="";if("undefined"!=typeof $(this).attr("data-envira-social-facebook-text")&&(w=decodeURIComponent($(this).data("envira-social-facebook-text")),w=w.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating facebook_text:"),console.log(w))),"undefined"!=typeof $(this).attr("data-envira-caption")){var v=decodeURIComponent($(this).data("envira-facebook-caption"));v=v.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating caption:"),console.log(v))}"undefined"!=typeof $(this).attr("data-envira-facebook-quote")&&(y=decodeURIComponent($(this).data("envira-facebook-quote")),y=y.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote:"),console.log(y))),"undefined"!=typeof $(this).attr("data-envira-title")&&(g=decodeURIComponent($(this).data("envira-title")),g=g.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title:"),console.log(g))),"undefined"!=typeof $(this).attr("data-envira-facebook-tags")&&(x=decodeURIComponent($(this).data("envira-facebook-tags")),x=x.replace(new RegExp("\\+","g")," "),x=x.replace(/-/g,""),envira_social.debug&&(console.log("updating tags:"),console.log(x))),"undefined"!=typeof $(this).attr("data-envira-social-picture")&&(s=decodeURIComponent($(this).data("envira-social-picture")),s=s.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating image:"),console.log(s)));var U=a.length>0?window.location.href.split("#")[0]+encodeURIComponent(a)+"&envira_album_id="+m+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+u:window.location.href.split("?")[0]+c+"?envira_album_id="+m+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+u+"&rand="+f+"&"+h;break;case"pinterest":var C="",I="pin-one",s="";"undefined"!=typeof $(this).attr("data-envira-social-pinterest-description")&&(C=decodeURIComponent($(this).data("envira-social-pinterest-description")),C=C.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest description"),console.log(C))),"undefined"!=typeof $(this).attr("data-envira-social-picture")&&(s=decodeURIComponent($(this).data("envira-social-picture")),s=s.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest image"),console.log(s))),"undefined"!=typeof $(this).attr("data-envira-pinterest-type")&&(I=decodeURIComponent($(this).data("envira-pinterest-type")),I=I.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest ptype"),console.log(I)));var U=a.length>0?window.location.href.split("#")[0]+encodeURIComponent(a)+"&envira_album_id="+m+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+u+"&"+h:window.location.href.split("?")[0]+"?envira_album_id="+m+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+u+"&rand="+f+"&"+h;envira_social.debug&&(console.log("pinterest link:"),console.log(s))}}if("pinterest"===t)"undefined"==typeof C&&"undefined"!=typeof v?C=v:"undefined"==typeof C&&(C=""),"pin-all"==I?PinUtils.pinAny({media:s,description:C,url:U}):PinUtils.pinOne({media:s,description:C,url:U});else if("facebook"===t){if(a.length>0)var E=U;else if(U.length>0)var E=U;else var E=window.location.href;envira_social.debug&&(console.log("sending facebook link:"),console.log(E)),FB.ui({method:"share",display:"popup",href:E,title:g,description:w,caption:v,picture:s,hashtag:x,quote:y})}else if("email"===t)window.location=o;else{var q=window.open(o,"Share","width="+i+",height="+n);envira_social.debug&&(console.log("url:"),console.log(o),console.log(encodeURIComponent(o)))}return!1}),$("div.envira-gallery-item-inner").each(function(){0===$(this).find(".envira-social-buttons .envira-social-network").length&&$(this).find("div.envira-social-buttons").remove()}),location.href.search("envira_social_sharing_close")>-1&&window.close()}),document.getElementsByClassName("button-facebook").onclick=function(){FB.ui({method:"share",display:"popup",href:"https://developers.facebook.com/docs/"},function(e){})};